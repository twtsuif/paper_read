# NeRF2Mesh

Delicate Textured Mesh Recovery from NeRF via Adaptive Surface Refinement

通过自适应表面细化，从 NeRF 恢复精致的纹理网格



![image-20230830091717875](https://cdn.jsdelivr.net/gh/twtsuif/picture/twtsuif2023-08-30/3d6b46956a0fb21dcbbd187e0eec1fad--494b--image-20230830091717875.png)

使用来自多视图 RGB 图像的漫反射和镜面纹理，重建高质量的表面mesh，很好地从对象级数据集推广到场景级数据集。

导出的纹理网格可立即用于常见的图形硬件和软件，从而促进各种下游应用程序。



## 架构图

![image-20230831145822693](https://cdn.jsdelivr.net/gh/twtsuif/picture/twtsuif2023-08-31/beb2d33e26b9c65e488a215a5681e568--b1c9--image-20230831145822693.png)

几何形状最初通过密度网格学习，提取以形成粗网络，优化为具有更精确表面和自适应面密度的细网格

外观是通过两个阶段共享的颜色网格来学习的，并分解为漫反射和镜面反射项。

收敛后，我们可以导出精细网格，展开其 UV 坐标，并将外观烘焙为纹理图像。



## 摘要

首先使用 NeRF 有效地初始化几何结构和视图依赖分解外观

随后，提取粗网格，迭代表面细化算法，根据重新投影的渲染误差，自适应调整顶点位置和面密度

联合细化外观和几何，烘培成纹理图像来实时渲染



## 简介

mesh的不规则性，直接重建网格很难，并且大多数仅限于对象级重建

MobileNeRF提出一种在grid mesh上优化，然而生成的mesh与真实表面相差甚远，纹理在特征空间而非RGB空间，导致编辑或操作不方便

获得精确表面mesh流行方法是SDF，通常产生过度平滑的几何形状，无法对薄结构进行建模，MarchingCubes会产生大量冗余的顶点和面来保存信息

NVdiffrec使用可微光栅化器，来优化可变形四面体网格，但仅限于对象级，无法恢复复杂拓扑，难以区分无界室外场景的前景和背景网格

表示间隙representation gap使得很难从volumetric NeRF中很难准确恢复表面mesh



volumetric NeRF适合从几何和外观高效地初始化



为了启用纹理编辑，将外观分解为与视图无关的漫反射和与视图相关的镜面反射，可将漫反射颜色导出为标准RGB图像纹理

镜面反射项导出为特征纹理，通过片段着色器的小型MLP生成与视图相关的颜色



## 相关工作

### NeRF场景重建

DVGO采用两个密集特征网格进行密度和外观编码，但密集网格导致更大的模型尺寸

控制模型大小 InstantNGP

一些方法想要分解未知照明下的反射率，来实现重新照明和纹理编辑

我们的目标：将NeRF转为纹理meshes



### 表面mesh场景重建

该研究领域的大多数方法都假设具有，固定拓扑的模板mesh

最近的方法都开始解决拓扑优化的问题

NVdiffrecMC中使用蒙特卡罗渲染进一步改进，可以分解材质和照明，必须准备前景掩码，来使用可微渲染优化对象边界



### 从NeRF中提取表面网格

SDF表面可以由zero level set确定

将SDF应用密度变换实现可微渲染，Marching Cubes从体积中提取表面网格

BakedSDF优化混合 SDF 体积表面表示并将其烘焙到网格中以进行实时渲染

探索无符号距离场UDF与SDF的组合解决，但仍然仅限于对象级

SAMURAI旨在联合恢复未知捕获条件下单个物体的相机姿势、几何形状和外观，并导出纹理mesh

MobileNeRF必须使用自定义着色器进行渲染且不方便编辑

最近工作发现**指数密度激活**可以帮助浓缩密度并形成更好的表面

我们还采用密度场来捕获正确的拓扑，因为表面可以进一步细化



## 方法

首先训练一个基于grid的NeRF，有效初始化网格的几何和外观。

提取粗网格并微调表面几何形状和外观。

训练完成后，可以以标准形式(wavefront OBJ和PNG)导出纹理表面网格



### 高效NeRF训练

我们随着最近基于grid的进展，采用两个独立的特征网格来提高NeRF的效率



**几何**

几何学习通过密度网格和浅层MLP ![image-20230831152632588](https://cdn.jsdelivr.net/gh/twtsuif/picture/twtsuif2023-08-31/135e9d4c0c253b36fe8ebdeb58620f27--4387--image-20230831152632588.png)

其中 φ 是促进更清晰表面的指数激活 [32]，Egeo 是可学习的多分辨率特征网格，x ∈ R3 是任何 3D 点的位置。



**外观分解**

NeRF通常在不假设照明或材料特性的情况下运行

NeRF建模外观就像黑盒子

为了解决这个问题，我们使用颜色网格和两个浅 MLP 将外观分解为与视图无关的漫反射颜色 cd 和与视图相关的镜面反射颜色 cs，表示如下：

![image-20230831153134735](https://cdn.jsdelivr.net/gh/twtsuif/picture/twtsuif2023-08-31/79ed9b55d2dcc7e0656f907e5f38bf56--259a--image-20230831153134735.png)

其中 ψ 指的是 sigmoid 激活，fs 表示位置 x 处镜面反射颜色的中间特征，d 表示视图方向。最终颜色是通过将两项相加获得的：

![image-20230831153157458](https://cdn.jsdelivr.net/gh/twtsuif/picture/twtsuif2023-08-31/11609c0e3058819ad50475a3361d60ce--7315--image-20230831153157458.png)

如图 3 所示，我们成功分离了漫反射项和镜面反射项。 R3中的漫反射颜色可以直接转换为RGB图像纹理。同时，镜面特征fs也可以转换为纹理，并且小MLP2可以适合下面的片段着色器[11]。因此，镜面反射颜色也可以在以后导出和渲染（详细信息请参见第 3.3 节）。

我们的方法是将光照条件烘焙到纹理中。这是因为估计环境光照对于现实数据集可能具有挑战性，并且之前的研究已经观察到这可能会导致渲染质量降低 [60, 33]。
